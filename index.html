<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Noisetown Ultimate — v4 (Per‑Stream Spaces, Spectrogram, Tooltips, Presets, Style Mode)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="styles/main.css">
</head>
<body>
<div id="app">
  <div id="toolbar">
      <span class="title">Noisetown Ultimate</span>
    <button id="startAudio" class="btn">Start Audio</button>
    <button id="addBlock" class="btn">Add Block</button>
    <button id="editToggle" class="btn" aria-pressed="false">Edit: OFF</button>
    <button id="styleMode" class="btn" aria-pressed="false">Style Mode: OFF</button>

    <select id="themePicker" class="btn"><option value="flat">Theme: Flat (Default)</option><option value="win98">Theme: Windows 98</option><option value="winxp">Theme: Windows XP</option></select>
<div class="spacer"></div>
    <button id="saveSession" class="btn">Save</button>
    <button id="savePreset" class="btn">Save Preset + Audio</button>
    <input id="loadFile" type="file" accept="application/json" style="display:none">
    <button id="loadSession" class="btn">Load</button>
    <input id="loadPresetFile" type="file" accept="application/json" style="display:none">
    <button id="loadPreset" class="btn">Load Preset</button>
  </div>
  <div id="main"></div>
  <div id="modeToast" role="status" aria-live="polite"></div>
</div>

<!-- Style panel -->
<div id="stylePanel" class="style-panel">
  <h4>Style Painter</h4>
  <div class="row">
    <label>Preset</label>
    <select id="stylePreset">
      <option value="">Custom…</option>
      <option value="bevel">Beveled</option>
      <option value="shadow">Shadow</option>
      <option value="soft">Soft Card</option>
      <option value="glow">Glow</option>
      <option value="flat">Flat</option>
      </select>
  </div>
  <div class="row">
    <label>Radius</label><input id="styRadius" type="range" min="0" max="20" step="1" value="8">
  </div>
  <div class="row">
    <label>Shadow</label><input id="styShadow" type="range" min="0" max="40" step="1" value="12">
  </div>
  <div class="row">
    <label>Apply to</label>
    <select id="styScope">
      <option value="element">This element</option>
      <option value="stream">This stream</option>
      <option value="block">This block</option>
      <option value="global">Global</option>
    </select>
  </div>
  <div class="row">
    <button id="styApply" class="btn">Apply</button>
    <button id="styResetTheme" class="btn">Reset</button>
    <button id="stySaveTheme" class="btn" style="margin-left:auto">Save Theme JSON</button>
  </div>
  <div class="small">Hover to select an element. Click to focus. Adjust, then Apply.</div>
</div>

<div id="audioLab" class="lab-panel">
  <h2>Digital Audio Creation Lab</h2>
  <p class="lab-intro">Craft new soundscapes with an integrated instrument rack, sample deck, and master controls tuned for live sketching.</p>
  <div class="lab-grid">
    <section class="lab-card" id="labInstrument">
      <h3>Virtual Instrument Rack</h3>
      <p>Use your computer keyboard (A–; keys) to play. Combine envelopes, filtering, ambience, and sample layers to sketch ideas directly in the browser.</p>
      <button type="button" class="btn lab-toggle" data-action="toggle-instrument">Enable Instrument</button>
      <div class="lab-control">
        <label>Instrument</label>
        <select data-param="voice">
          <option value="classic">Classic Synth</option>
          <option value="supersaw">Supersaw Stack</option>
          <option value="pulse">Pulse Lead</option>
          <option value="organ">Drawbar Organ</option>
          <option value="noise">Noise Pad</option>
        </select>
      </div>
      <div class="lab-control">
        <label>Waveform</label>
        <select data-param="wave">
          <option value="sine">Sine</option>
          <option value="triangle">Triangle</option>
          <option value="sawtooth">Saw</option>
          <option value="square">Square</option>
        </select>
      </div>
      <div class="lab-control">
        <label>Master Volume</label>
        <input type="range" data-param="master" min="0" max="1.5" step="0.01" value="1">
        <span class="small" data-readout="master">100%</span>
      </div>
      <div class="lab-control">
        <label>Instrument Volume</label>
        <input type="range" data-param="volume" min="0" max="1.5" step="0.01" value="0.9">
        <span class="small" data-readout="volume">90%</span>
      </div>
      <div class="lab-control">
        <label>Octave</label>
        <input type="range" data-param="octave" min="-2" max="2" step="1" value="0">
        <span class="small" data-readout="octave">0</span>
      </div>
      <div class="lab-control">
        <label>Attack</label>
        <input type="range" data-param="attack" min="0.005" max="0.5" step="0.005" value="0.02">
        <span class="small" data-readout="attack">20 ms</span>
      </div>
      <div class="lab-control">
        <label>Release</label>
        <input type="range" data-param="release" min="0.05" max="2" step="0.05" value="0.4">
        <span class="small" data-readout="release">0.40 s</span>
      </div>
      <div class="lab-control">
        <label>Filter</label>
        <input type="range" data-param="cutoff" min="500" max="18000" step="100" value="12000">
        <span class="small" data-readout="cutoff">12.0 kHz</span>
      </div>
      <div class="lab-control">
        <label>Resonance</label>
        <input type="range" data-param="resonance" min="0.1" max="20" step="0.1" value="1.2">
        <span class="small" data-readout="resonance">Q 1.2</span>
      </div>
      <div class="lab-control">
        <label>Reverb</label>
        <input type="range" data-param="reverb" min="0" max="1" step="0.01" value="0.25">
        <span class="small" data-readout="reverb">25%</span>
      </div>
      <div class="lab-control">
        <label>Sample Deck</label>
        <div class="lab-sampler">
          <button type="button" class="btn" data-action="load-sample">Load Sample</button>
          <input type="file" accept="audio/*" data-sample-file hidden>
          <button type="button" class="btn" data-action="play-sample" disabled>Play</button>
          <button type="button" class="btn" data-action="stop-sample" disabled>Stop</button>
          <label class="lab-switch">
            <input type="checkbox" data-param="sample-loop">
            <span>Loop</span>
          </label>
        </div>
        <div class="small" data-status="sample">No sample loaded</div>
      </div>
      <div class="lab-help small">Tip: Toggle Edit Mode off while performing to avoid accidental drags. Samples play through the same effects and volume as the instrument.</div>
    </section>
  </div>
</div>

<script src="scripts/app.js"></script>
<script src="scripts/mods-advanced.js"></script>
<script src="scripts/mod-apply.js"></script>
<script src="scripts/toolbar.js"></script>
<script src="scripts/tools.js"></script>
</body>
</html>
